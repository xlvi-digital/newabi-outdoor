<!DOCTYPE html>
<html lang="en" x-data="productPage()">
  <head>
    <meta charset="UTF-8" />
    <link rel="shortcut icon" href="img/logo/logo-newabi.png" />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="assets/sweetalert2/sweetalert2.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/boxicons@latest/css/boxicons.min.css" />
    <link rel="stylesheet" href="style.css" />
    <link rel="stylesheet" href="responsive.css" />

    <title>NEWABIOUTDOOR | Single Product</title>

    <script>
      document.addEventListener("alpine:init", () => {
        Alpine.store("cart", {
          items: JSON.parse(localStorage.getItem("cartItems") || "[]"),
          get count() {
            return this.items.reduce((acc, p) => acc + p.quantity, 0);
          },
          add(product) {
            const existing = this.items.find((p) => p.id === product.id);
            if (existing) {
              existing.quantity += product.quantity || 1;
            } else {
              this.items.push({ ...product, quantity: product.quantity || 1 });
            }
            this.save();
          },
          remove(id) {
            this.items = this.items.filter((p) => p.id !== id);
            this.save();
          },
          save() {
            localStorage.setItem("cartItems", JSON.stringify(this.items));
            window.dispatchEvent(new Event("cart-updated"));
          },
          clear() {
            this.items = [];
            this.save();
          },
        });
      });
    </script>
    <style>
      .links-product a:hover {
        text-decoration: underline;
      }
    </style>
  </head>
  <body>
    <!-- Navbar -->
    <div class="container">
      <div class="navbar" x-data="cartBadge()">
        <div class="logo">
          <a href="index.html"> <img src="img/logo/newabi-logo.png" width="125px" /></a>
        </div>
        <nav>
          <ul id="menuItems">
            <li><a href="index.html">Home</a></li>
            <li><a href="products.html">Product</a></li>
            <li><a href="https://masreyxlvi.github.io/newabioutdoor/" target="_blank">About</a></li>
            <li><a href="contact.html">Contact</a></li>
          </ul>
        </nav>
        <div
          class="cart-icon"
          x-data="{ cartCount: 0 }"
          x-init="
        cartCount = $store.cart.count;
        window.addEventListener('cart-updated', () => {
          cartCount = $store.cart.count;
        });
      "
        >
          <a href="cart.html">
            <img src="images/cart.png" width="30px" height="30px" alt="cart" />
            <span class="cart-badge" x-text="cartCount">0</span>
          </a>
        </div>
        <img src="images/menu.png" class="menu-icon" onclick="menuToggle()" />
      </div>
    </div>

    <!-- Single Product -->
    <div class="small-container single-product" x-init="init()">
      <template x-if="product">
        <div class="row">
          <div class="col-2">
            <img :src="mainImage" width="100%" id="product-img" />
            <div class="small-img-row">
              <template x-for="img in product.imgs" :key="img">
                <div class="small-img-col">
                  <img :src="img" width="100%" class="small-img" @click="mainImage = img" />
                </div>
              </template>
            </div>
          </div>
          <div class="col-2">
            <p class="links-product">
              <a href="index.html">Home</a> /
              <a href="products.html" x-text="categoryName" style="text-transform: capitalize"></a>
            </p>
            <h1 x-text="product.name"></h1>
            <h4 x-text="rupiah(product.price) + ' / Hari'"></h4>

            <input type="number" min="1" x-model.number="quantity" />
            <a href="#" @click.prevent="addToCart(product, quantity)" class="btn">Add to Cart</a>
            <h3>Product Detail <i class="bx bx-right-indent"></i></h3>
            <p x-text="product.desc ? product.desc : 'No description available.'"></p>
          </div>
        </div>
      </template>
      <template x-if="!product">
        <p>Produk tidak ditemukan.</p>
      </template>
    </div>

    <!-- Related Products -->
    <section id="product" class="product">
      <div class="small-container">
        <div class="row row-2">
          <h2>Related Product</h2>
          <p><a href="products.html">View More</a></p>
        </div>
        <div class="row">
          <template x-for="item in relatedProducts" :key="item.id">
            <div class="col-4">
              <a :href="`single-product.html?id=${item.id}`">
                <img :src="item.imgs && item.imgs.length > 0 ? item.imgs[0] : 'img/default.jpg'" alt="Product Image" class="product-img" />
              </a>
              <h4 x-text="item.name"></h4>
              <p x-text="'Rp ' + item.price.toLocaleString('id-ID')"></p>
              <a href="#" @click.prevent="$store.cart.add({...item, quantity: 1})" class="btn" style="font-size: 0.8rem; margin-top: 15px">Add to Cart</a>
            </div>
          </template>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <div class="footer">
      <div class="container">
        <div class="row">
          <div class="footer-col-1">
            <h3>Tentang Kami</h3>
            <p>Newabi Outdoor adalah penyedia jasa rental alat camping & adventure gear terpercaya sejak 2024.</p>
          </div>
          <div class="footer-col-2">
            <img src="img/logo/newabi-logo.png" alt="Newabi Outdoor" />
            <p>Petualangan dimulai dari sini.</p>
          </div>
          <div class="footer-col-3">
            <h3>Ikuti Kami</h3>
            <ul>
              <a href="https://www.instagram.com/newabioutdoor/" target="_blank"><li>Instagram</li></a>
              <li>TikTok</li>
              <li>WhatsApp</li>
            </ul>
          </div>
        </div>
        <hr />
        <p class="copyright">© 2024 Newabi Outdoor — Sewa Alat Camping Lengkap untuk Setiap Petualangan</p>
      </div>
    </div>

    <!-- Scripts -->
    <script src="script.js"></script>
    <script src="assets/jquery.js"></script>
    <script src="assets/app.js"></script>
    <script src="assets/sweetalert2/sweetalert2.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>

    <script>
      // Toggle menu
      var menuItems = document.getElementById("menuItems");
      menuItems.style.maxHeight = "0px";
      function menuToggle() {
        menuItems.style.maxHeight = menuItems.style.maxHeight === "0px" ? "200px" : "0px";
      }

      function productPage() {
        return {
          product: null,
          mainImage: "img/default.jpg",
          quantity: 1,
          relatedProducts: [],
          categoryName: "",
          itemsByCategory: {
            tenda: [
              { id: 1, name: "Big Dome 6 Pro", imgs: ["img/product/tenda/2.jpg"], price: 75000, desc: "Tenda besar berkapasitas hingga 6 orang, cocok untuk keluarga atau tim ekspedisi dengan ventilasi optimal dan desain tahan hujan." },
              { id: 2, name: "Easy Dome 2", imgs: ["img/product/tenda/3.jpg"], price: 20000, desc: "Tenda ringan untuk 2 orang, mudah dipasang dan dibongkar, ideal untuk pendaki solo atau pasangan camper." },
              { id: 3, name: "Bespot", imgs: ["img/product/tenda/4.jpg"], price: 35000, desc: "Tenda ringkas dengan sistem tiang fleksibel dan perlindungan UV, cocok untuk perjalanan singkat dan camping ringan." },
              { id: 4, name: "Borneo 3", imgs: ["img/product/tenda/5.jpg"], price: 40000, desc: "Tenda 3 orang dengan rangka kuat dan lapisan anti-air, memberikan kenyamanan tidur di segala cuaca." },
              { id: 5, name: "Borneo 4 Black Red", imgs: ["img/product/tenda/8.jpg"], price: 50000, desc: "Tenda 4 orang berdesain modern dengan warna hitam elegan, kuat menghadapi angin dan hujan deras." },
              { id: 6, name: "Quechua Arpenaz 2", imgs: ["img/product/tenda/6.jpg"], price: 30000, desc: "Tenda kompak untuk 2 orang dengan sirkulasi udara baik dan daya tahan terhadap cuaca ekstrem." },
              { id: 7, name: "Great Outdoor Java 4", imgs: ["img/product/tenda/7.jpg"], price: 40000, desc: "Tenda keluarga 4 orang dengan desain kubah luas dan bahan tahan air, cocok untuk camping di alam terbuka." },
              { id: 8, name: "Borneo 4 Black Yellow", imgs: ["img/product/tenda/9.jpg"], price: 50000, desc: "Versi stylish dari seri Borneo dengan kombinasi warna hitam dan kuning, tahan air dan mudah dipasang." },
              { id: 9, name: "Great Outdoor Java 6", imgs: ["img/product/tenda/10.jpg"], price: 60000, desc: "Tenda besar 6 orang dengan ruang dalam luas dan dua pintu akses, nyaman untuk keluarga besar atau tim." },
              { id: 10, name: "Arpanaz Family 4.1", imgs: ["img/product/tenda/11.jpg"], price: 60000, desc: "Tenda keluarga dengan dua ruangan terpisah, memberikan privasi dan kenyamanan ekstra selama berkemah." },
            ],

            carrier: [
              { id: 11, name: "Daypack", imgs: ["img/product/carrier/2.jpg"], price: 10000, desc: "Tas harian berkapasitas kecil dengan banyak kompartemen, cocok untuk hiking singkat atau perjalanan ringan." },
              { id: 12, name: "Sunature Futura Pro", imgs: ["img/product/carrier/3.jpg"], price: 20000, desc: "Carrier ergonomis dengan sistem ventilasi punggung dan tali bahu empuk untuk perjalanan panjang." },
              { id: 13, name: "Deuter Futura 32", imgs: ["img/product/carrier/4.jpg"], price: 35000, desc: "Ransel premium 32L dengan ventilasi Aircomfort dan rangka aluminium ringan untuk kenyamanan maksimal." },
              { id: 14, name: "Osprey Kestrey 48", imgs: ["img/product/carrier/1.jpg"], price: 40000, desc: "Carrier profesional berkapasitas 48L dengan desain kuat, nyaman, dan banyak saku tambahan untuk petualangan jauh." },
            ],

            masak: [
              { id: 15, name: "Kompor Kotak", imgs: ["img/product/masak/masak1.jpg"], price: 12000, desc: "Kompor gas bentuk kotak yang praktis dan stabil, mudah digunakan di area berangin." },
              { id: 16, name: "Kompor Mawar", imgs: ["img/product/masak/masak2.jpg"], price: 15000, desc: "Kompor portabel dengan bentuk seperti bunga mawar, api besar dan merata, cocok untuk memasak cepat." },
              { id: 17, name: "Kompor Koper", imgs: ["img/product/masak/masak3.jpg"], price: 20000, desc: "Kompor lipat model koper dengan pelindung angin, mudah dibawa dan disimpan." },
              { id: 18, name: "Cooking Seet 200", imgs: ["img/product/masak/masak4.jpg"], price: 12000, desc: "Set peralatan masak ringan berbahan aluminium, cocok untuk 1–2 orang." },
              { id: 19, name: "Cooking Seet 308", imgs: ["img/product/masak/masak5.jpg"], price: 15000, desc: "Peralatan masak outdoor lengkap untuk 3–4 orang, anti lengket dan mudah dibersihkan." },
              { id: 20, name: "Gas Portable Refil", imgs: ["img/product/masak/masak6.jpg"], price: 8000, desc: "Tabung gas portabel isi ulang untuk kompor camping, ringan dan mudah dipasang." },
            ],

            penerangan: [
              { id: 21, name: "HeadLamp", imgs: ["img/product/penerangan/penerangan1.jpg"], price: 8000, desc: "Lampu kepala dengan cahaya terang dan adjustable strap, ideal untuk aktivitas malam di alam terbuka." },
              { id: 22, name: "Headlamp Electric", imgs: ["img/product/penerangan/penerangan2.jpg"], price: 10000, desc: "Headlamp rechargeable dengan mode cahaya ganda dan ketahanan air tinggi." },
              { id: 23, name: "Lampu Tenda", imgs: ["img/product/penerangan/penerangan3.jpg"], price: 8000, desc: "Lampu gantung ringan untuk menerangi bagian dalam tenda dengan cahaya lembut dan tahan lama." },
            ],

            pribadi: [
              { id: 24, name: "Sleping Bag", imgs: ["img/product/pribadi/pribadi1.jpg"], price: 8000, desc: "Sleeping bag hangat dan nyaman untuk suhu malam dingin, mudah dilipat dan dibawa." },
              { id: 25, name: "Tracking Pole", imgs: ["img/product/pribadi/pribadi2.jpg"], price: 10000, desc: "Tongkat trekking adjustable yang membantu keseimbangan saat mendaki medan curam." },
              { id: 26, name: "Sarung Tangan", imgs: ["img/product/pribadi/pribadi3.jpg"], price: 10000, desc: "Sarung tangan outdoor anti slip dan tahan air untuk perlindungan tangan saat mendaki." },
              { id: 27, name: "Sepatu Tracking", imgs: ["img/product/pribadi/pribadi4.jpg"], price: 25000, desc: "Sepatu hiking tahan air dengan sol anti licin, memberikan kenyamanan maksimal di jalur terjal." },
            ],

            tambahan: [
              { id: 28, name: "Matras Spons", imgs: ["img/product/tambahan/tambahan1.jpg"], price: 5000, desc: "Matras ringan berbahan spons untuk alas tidur yang empuk dan nyaman di dalam tenda." },
              { id: 29, name: "Matras Lipat Spons", imgs: ["img/product/tambahan/tambahan2.jpg"], price: 10000, desc: "Matras spons yang dapat dilipat, mudah dibawa dan tidak memakan tempat." },
              { id: 30, name: "Flysheet", imgs: ["img/product/tambahan/tambahan3.jpg"], price: 15000, desc: "Lembaran pelindung anti air untuk tenda atau area duduk, efektif menahan hujan dan panas." },
              { id: 31, name: "Meja & Kursi Lipat", imgs: ["img/product/tambahan/tambahan4.jpg"], price: 15000, desc: "Set meja dan kursi lipat praktis untuk makan atau bersantai saat camping." },
            ],
          },

          init() {
            const params = new URLSearchParams(window.location.search);
            const id = parseInt(params.get("id"));
            if (!id) return;

            for (let cat in this.itemsByCategory) {
              const prod = this.itemsByCategory[cat].find((p) => p.id === id);
              if (prod) {
                this.product = prod;
                this.mainImage = prod.imgs && prod.imgs.length > 0 ? prod.imgs[0] : "img/default.jpg";
                this.categoryName = cat.charAt(0).toUpperCase() + cat.slice(1);
                this.relatedProducts = this.itemsByCategory[cat]
                  .filter((p) => p.id !== id)
                  .slice(0, 4)
                  .map((p) => ({ ...p, imgs: p.imgs && p.imgs.length > 0 ? p.imgs : ["img/default.jpg"] }));
                break;
              }
            }
          },
          addToCart(item, qty = 1) {
            if (Alpine.store("cart")) {
              Alpine.store("cart").add({ ...item, quantity: qty });
              Swal.fire("Success", "Product added to cart", "success");
            }
          },
          rupiah(val) {
            return "Rp " + val.toLocaleString("id-ID");
          },
        };
      }
    </script>
  </body>
</html>
